<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{{url_for('static',filename='style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理者画面</title>

<body>
    


    <!-- 新しいテーブルを追加 -->
    <table border="1">
        <thead>
            <tr>
                <th>年月</th>
                <th>支払者</th>
                <th>支払金額</th>
                <th>決済</th>
            </tr>
        </thead>
        <tbody>
            {% for detail in payment_details %}  <!-- payment_detailsを表示 -->
            <tr>
                <td>{{ detail[0] }}</td>
                <td>{{ detail[1] }}</td>
                <td>
                    <span id="pay-value-{{ loop.index }}">{{ detail[2] }}</span>
                    <button type="button" onclick="toggleEdit('pay', {{ loop.index }})">編集</button>
                    <div id="pay-edit-{{ loop.index }}" style="display:none;">
                        <form action="{{ url_for('update_payment') }}" method="post">
                            <input type="hidden" name="yyyymm" value="{{ detail[0] }}">
                            <input type="number" name="pay" value="{{ detail[2] }}" id="pay-input-{{ loop.index }}">
                            <button type="submit" name="submit-pay-{{ loop.index }}">確定</button>
                        </form>
                    </div>
                </td>
                <td>
                    {{ detail[3] }}
                    <button type="button" onclick="toggleEdit('settlement', {{ loop.index }})">編集</button>
                    <div id="settlement-edit-{{ loop.index }}" style="display:none;">
                        <form action="{{ url_for('update_settlement') }}" method="post">
                            <input type="hidden" name="yyyymm" value="{{ detail[0] }}">
                            <input type="text" name="settlement" value="{{ detail[3] }}" id="settlement-input-{{ loop.index }}">
                            <button type="submit" name="submit-settlement-{{ loop.index }}">確定</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <table>
        <thead>
            <tr>
                <th>年月</th>
                <th>食費</th>
                <th>家賃</th>
                <th>水道代</th>
                <th>電気代</th>
                <th>ガス代</th>
                <th>生活費合計</th>
                <th>生活費_食費</th>
                <th>折半計算</th>
                <th>家事割合適用後折半代金</th>
                <th>荻田%</th>
                <th>支払金額</th>
                <th>支払人</th>
                <th>支払完了判定</th>
            </tr>
        </thead>
        <tbody>
            {% for record in records %}
            <tr>
                <td>{{ record[0] }}</td>
                <td>{{ record[1] }}</td>
                <td>{{ record[2] }}</td>
                <td>{{ record[3] }}</td>
                <td>{{ record[4] }}</td>
                <td>{{ record[5] }}</td>
                <td>{{ record[6] }}</td>
                <td>{{ record[7] }}</td>
                <td>{{ record[8] }}</td>
                <td>{{ record[9] }}</td>
                <td>{{ record[10] }}</td>
                <td>{{ record[11] }}</td>
                <td>{{ record[12] }}</td>
                <td>{{ record[13] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>


    <a href="{{ url_for('index')}}">家事実績入力一覧へ戻る</a>
    <br>
    <br>
    <p>注意書き 生活費を支払う人、食費を支払う人で分担しています。食費のほうが安くなる前提でいます。 </p>
    <p>折半したいので生活費-食費= 食費払っている人が払う折半分のお金です。</p>
    <p>折半分の25%から家事をした割合だけを割引して折半支払い分を計算します。</p>
    <p>(生活費+食費)/2 - ((生活費+食費)/2*25%*家事割合)</p>
    <p>全体の半分から25%分を家事をした分だけカットして支払う。</p>


</body>


<script>
    function toggleEdit(type, index) {
        const editDiv = document.getElementById(type + '-edit-' + index);
        editDiv.style.display = editDiv.style.display === 'none' ? 'block' : 'none';
    }

    function confirmEdit(type, index) {
        const inputValue = document.getElementById(type + '-input-' + index).value;
        document.getElementById(type + '-value-' + index).innerText = inputValue;
        // ここでAJAXを使ってサーバーに更新を送信することもできます
        toggleEdit(type, index); // 入力フォームを閉じる
    }

    function updateValue(type, index, value) {
        document.getElementById(type + '-value-' + index).innerText = value;
        // ここでAJAXを使ってサーバーに更新を送信することもできます
    }
</script>

</html>